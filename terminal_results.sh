
(tf_env) marioban@MacBook-Pro-od-Mario braint_tumor_detection_project % "/Users/marioban/Desktop/Faks/Computer Vision/braint_tumor_detection_project/tf_env/bin/pyt
hon" "/Users/marioban/Desktop/Faks/Computer Vision/braint_tumor_detection_project/tumor_detection.py"
Found 4571 images belonging to 4 classes.
Found 1141 images belonging to 4 classes.
Found 1311 images belonging to 4 classes.
Epoch 1/30
/Users/marioban/Desktop/Faks/Computer Vision/braint_tumor_detection_project/tf_env/lib/python3.9/site-packages/keras/src/trainers/data_adapters/py_dataset_adapter.py:122: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.
  self._warn_if_super_not_called()
143/143 ━━━━━━━━━━━━━━━━━━━━ 266s 2s/step - accuracy: 0.3645 - loss: 1.3257 - val_accuracy: 0.2305 - val_loss: 1.3901 - learning_rate: 1.0000e-05
Epoch 2/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 245s 2s/step - accuracy: 0.7299 - loss: 0.8962 - val_accuracy: 0.2682 - val_loss: 1.3966 - learning_rate: 1.0000e-05
Epoch 3/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 243s 2s/step - accuracy: 0.8213 - loss: 0.5944 - val_accuracy: 0.3138 - val_loss: 1.3849 - learning_rate: 1.0000e-05
Epoch 4/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 243s 2s/step - accuracy: 0.8507 - loss: 0.4503 - val_accuracy: 0.4093 - val_loss: 1.3773 - learning_rate: 1.0000e-05
Epoch 5/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 245s 2s/step - accuracy: 0.8727 - loss: 0.3761 - val_accuracy: 0.5250 - val_loss: 1.1241 - learning_rate: 1.0000e-05
Epoch 6/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 246s 2s/step - accuracy: 0.8956 - loss: 0.3130 - val_accuracy: 0.7590 - val_loss: 0.6337 - learning_rate: 1.0000e-05
Epoch 7/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 215s 1s/step - accuracy: 0.8985 - loss: 0.2944 - val_accuracy: 0.8098 - val_loss: 0.4978 - learning_rate: 1.0000e-05
Epoch 8/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 208s 1s/step - accuracy: 0.9086 - loss: 0.2696 - val_accuracy: 0.8440 - val_loss: 0.4193 - learning_rate: 1.0000e-05
Epoch 9/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 227s 2s/step - accuracy: 0.9095 - loss: 0.2513 - val_accuracy: 0.8554 - val_loss: 0.3884 - learning_rate: 1.0000e-05
Epoch 10/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 634s 4s/step - accuracy: 0.9187 - loss: 0.2231 - val_accuracy: 0.8633 - val_loss: 0.3667 - learning_rate: 1.0000e-05
Epoch 11/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 760s 5s/step - accuracy: 0.9208 - loss: 0.2162 - val_accuracy: 0.8747 - val_loss: 0.3387 - learning_rate: 1.0000e-05
Epoch 12/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 203s 1s/step - accuracy: 0.9245 - loss: 0.2101 - val_accuracy: 0.8677 - val_loss: 0.3570 - learning_rate: 1.0000e-05
Epoch 13/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 207s 1s/step - accuracy: 0.9284 - loss: 0.1984 - val_accuracy: 0.8799 - val_loss: 0.3259 - learning_rate: 1.0000e-05
Epoch 14/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 209s 1s/step - accuracy: 0.9389 - loss: 0.1784 - val_accuracy: 0.8799 - val_loss: 0.3149 - learning_rate: 1.0000e-05
Epoch 15/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 208s 1s/step - accuracy: 0.9355 - loss: 0.1817 - val_accuracy: 0.8966 - val_loss: 0.2967 - learning_rate: 1.0000e-05
Epoch 16/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 210s 1s/step - accuracy: 0.9431 - loss: 0.1742 - val_accuracy: 0.9001 - val_loss: 0.2914 - learning_rate: 1.0000e-05
Epoch 17/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 213s 1s/step - accuracy: 0.9422 - loss: 0.1645 - val_accuracy: 0.9097 - val_loss: 0.2614 - learning_rate: 1.0000e-05
Epoch 18/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 214s 1s/step - accuracy: 0.9426 - loss: 0.1506 - val_accuracy: 0.9124 - val_loss: 0.2799 - learning_rate: 1.0000e-05
Epoch 19/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 212s 1s/step - accuracy: 0.9466 - loss: 0.1557 - val_accuracy: 0.9089 - val_loss: 0.2722 - learning_rate: 1.0000e-05
Epoch 20/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 213s 1s/step - accuracy: 0.9487 - loss: 0.1361 - val_accuracy: 0.9080 - val_loss: 0.2836 - learning_rate: 1.0000e-05
Epoch 21/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 207s 1s/step - accuracy: 0.9547 - loss: 0.1212 - val_accuracy: 0.9106 - val_loss: 0.2600 - learning_rate: 2.0000e-06
Epoch 22/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 206s 1s/step - accuracy: 0.9524 - loss: 0.1301 - val_accuracy: 0.9045 - val_loss: 0.2649 - learning_rate: 2.0000e-06
Epoch 23/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 205s 1s/step - accuracy: 0.9488 - loss: 0.1408 - val_accuracy: 0.9053 - val_loss: 0.2942 - learning_rate: 2.0000e-06
Epoch 24/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 222s 2s/step - accuracy: 0.9446 - loss: 0.1500 - val_accuracy: 0.9159 - val_loss: 0.2589 - learning_rate: 2.0000e-06
Epoch 25/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 205s 1s/step - accuracy: 0.9566 - loss: 0.1253 - val_accuracy: 0.9194 - val_loss: 0.2442 - learning_rate: 2.0000e-06
Epoch 26/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 206s 1s/step - accuracy: 0.9550 - loss: 0.1318 - val_accuracy: 0.9246 - val_loss: 0.2400 - learning_rate: 2.0000e-06
Epoch 27/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 207s 1s/step - accuracy: 0.9576 - loss: 0.1259 - val_accuracy: 0.9053 - val_loss: 0.2689 - learning_rate: 2.0000e-06
Epoch 28/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 211s 1s/step - accuracy: 0.9626 - loss: 0.1139 - val_accuracy: 0.9045 - val_loss: 0.2605 - learning_rate: 2.0000e-06
Epoch 29/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 211s 1s/step - accuracy: 0.9541 - loss: 0.1222 - val_accuracy: 0.9124 - val_loss: 0.2503 - learning_rate: 2.0000e-06
Epoch 30/30
143/143 ━━━━━━━━━━━━━━━━━━━━ 212s 1s/step - accuracy: 0.9589 - loss: 0.1097 - val_accuracy: 0.9115 - val_loss: 0.2625 - learning_rate: 1.0000e-06
36/36 ━━━━━━━━━━━━━━━━━━━━ 11s 290ms/step - accuracy: 0.9104 - loss: 0.2555
Validation Accuracy: 0.907975435256958
41/41 ━━━━━━━━━━━━━━━━━━━━ 12s 285ms/step - accuracy: 0.8926 - loss: 0.2996
Test Accuracy: 0.9130434989929199
36/36 ━━━━━━━━━━━━━━━━━━━━ 13s 326ms/step
41/41 ━━━━━━━━━━━━━━━━━━━━ 14s 331ms/step
              precision    recall  f1-score   support

      glioma       0.21      0.21      0.21       264
  meningioma       0.21      0.22      0.21       267
     notumor       0.25      0.24      0.25       319
   pituitary       0.27      0.27      0.27       291

    accuracy                           0.24      1141
   macro avg       0.24      0.24      0.24      1141
weighted avg       0.24      0.24      0.24      1141

              precision    recall  f1-score   support

      glioma       0.94      0.92      0.93       300
  meningioma       0.90      0.77      0.83       306
     notumor       0.93      0.95      0.94       405
   pituitary       0.88      1.00      0.93       300

    accuracy                           0.91      1311
   macro avg       0.91      0.91      0.91      1311
weighted avg       0.91      0.91      0.91      1311

/Users/marioban/Desktop/Faks/Computer Vision/braint_tumor_detection_project/tumor_detection.py:221: RuntimeWarning: invalid value encountered in cast
  heatmap = np.uint8(255 * heatmap)
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)      │ (None, 224, 224, 3)       │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ rescaling (Rescaling)         │ (None, 224, 224, 3)       │               0 │ input_layer[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ normalization (Normalization) │ (None, 224, 224, 3)       │               7 │ rescaling[0][0]            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ rescaling_1 (Rescaling)       │ (None, 224, 224, 3)       │               0 │ normalization[0][0]        │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ stem_conv_pad (ZeroPadding2D) │ (None, 225, 225, 3)       │               0 │ rescaling_1[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ stem_conv (Conv2D)            │ (None, 112, 112, 32)      │             864 │ stem_conv_pad[0][0]        │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ stem_bn (BatchNormalization)  │ (None, 112, 112, 32)      │             128 │ stem_conv[0][0]            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ stem_activation (Activation)  │ (None, 112, 112, 32)      │               0 │ stem_bn[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_dwconv                │ (None, 112, 112, 32)      │             288 │ stem_activation[0][0]      │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_bn                    │ (None, 112, 112, 32)      │             128 │ block1a_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_activation            │ (None, 112, 112, 32)      │               0 │ block1a_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_se_squeeze            │ (None, 32)                │               0 │ block1a_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_se_reshape (Reshape)  │ (None, 1, 1, 32)          │               0 │ block1a_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_se_reduce (Conv2D)    │ (None, 1, 1, 8)           │             264 │ block1a_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_se_expand (Conv2D)    │ (None, 1, 1, 32)          │             288 │ block1a_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_se_excite (Multiply)  │ (None, 112, 112, 32)      │               0 │ block1a_activation[0][0],  │
│                               │                           │                 │ block1a_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_project_conv (Conv2D) │ (None, 112, 112, 16)      │             512 │ block1a_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block1a_project_bn            │ (None, 112, 112, 16)      │              64 │ block1a_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_expand_conv (Conv2D)  │ (None, 112, 112, 96)      │           1,536 │ block1a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_expand_bn             │ (None, 112, 112, 96)      │             384 │ block2a_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_expand_activation     │ (None, 112, 112, 96)      │               0 │ block2a_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_dwconv_pad            │ (None, 113, 113, 96)      │               0 │ block2a_expand_activation… │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_dwconv                │ (None, 56, 56, 96)        │             864 │ block2a_dwconv_pad[0][0]   │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_bn                    │ (None, 56, 56, 96)        │             384 │ block2a_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_activation            │ (None, 56, 56, 96)        │               0 │ block2a_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_se_squeeze            │ (None, 96)                │               0 │ block2a_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_se_reshape (Reshape)  │ (None, 1, 1, 96)          │               0 │ block2a_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_se_reduce (Conv2D)    │ (None, 1, 1, 4)           │             388 │ block2a_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_se_expand (Conv2D)    │ (None, 1, 1, 96)          │             480 │ block2a_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_se_excite (Multiply)  │ (None, 56, 56, 96)        │               0 │ block2a_activation[0][0],  │
│                               │                           │                 │ block2a_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_project_conv (Conv2D) │ (None, 56, 56, 24)        │           2,304 │ block2a_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2a_project_bn            │ (None, 56, 56, 24)        │              96 │ block2a_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_expand_conv (Conv2D)  │ (None, 56, 56, 144)       │           3,456 │ block2a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_expand_bn             │ (None, 56, 56, 144)       │             576 │ block2b_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_expand_activation     │ (None, 56, 56, 144)       │               0 │ block2b_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_dwconv                │ (None, 56, 56, 144)       │           1,296 │ block2b_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_bn                    │ (None, 56, 56, 144)       │             576 │ block2b_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_activation            │ (None, 56, 56, 144)       │               0 │ block2b_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_se_squeeze            │ (None, 144)               │               0 │ block2b_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_se_reshape (Reshape)  │ (None, 1, 1, 144)         │               0 │ block2b_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_se_reduce (Conv2D)    │ (None, 1, 1, 6)           │             870 │ block2b_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_se_expand (Conv2D)    │ (None, 1, 1, 144)         │           1,008 │ block2b_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_se_excite (Multiply)  │ (None, 56, 56, 144)       │               0 │ block2b_activation[0][0],  │
│                               │                           │                 │ block2b_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_project_conv (Conv2D) │ (None, 56, 56, 24)        │           3,456 │ block2b_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_project_bn            │ (None, 56, 56, 24)        │              96 │ block2b_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_drop (Dropout)        │ (None, 56, 56, 24)        │               0 │ block2b_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block2b_add (Add)             │ (None, 56, 56, 24)        │               0 │ block2b_drop[0][0],        │
│                               │                           │                 │ block2a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_expand_conv (Conv2D)  │ (None, 56, 56, 144)       │           3,456 │ block2b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_expand_bn             │ (None, 56, 56, 144)       │             576 │ block3a_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_expand_activation     │ (None, 56, 56, 144)       │               0 │ block3a_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_dwconv_pad            │ (None, 59, 59, 144)       │               0 │ block3a_expand_activation… │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_dwconv                │ (None, 28, 28, 144)       │           3,600 │ block3a_dwconv_pad[0][0]   │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_bn                    │ (None, 28, 28, 144)       │             576 │ block3a_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_activation            │ (None, 28, 28, 144)       │               0 │ block3a_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_se_squeeze            │ (None, 144)               │               0 │ block3a_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_se_reshape (Reshape)  │ (None, 1, 1, 144)         │               0 │ block3a_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_se_reduce (Conv2D)    │ (None, 1, 1, 6)           │             870 │ block3a_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_se_expand (Conv2D)    │ (None, 1, 1, 144)         │           1,008 │ block3a_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_se_excite (Multiply)  │ (None, 28, 28, 144)       │               0 │ block3a_activation[0][0],  │
│                               │                           │                 │ block3a_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_project_conv (Conv2D) │ (None, 28, 28, 40)        │           5,760 │ block3a_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3a_project_bn            │ (None, 28, 28, 40)        │             160 │ block3a_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_expand_conv (Conv2D)  │ (None, 28, 28, 240)       │           9,600 │ block3a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_expand_bn             │ (None, 28, 28, 240)       │             960 │ block3b_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_expand_activation     │ (None, 28, 28, 240)       │               0 │ block3b_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_dwconv                │ (None, 28, 28, 240)       │           6,000 │ block3b_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_bn                    │ (None, 28, 28, 240)       │             960 │ block3b_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_activation            │ (None, 28, 28, 240)       │               0 │ block3b_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_se_squeeze            │ (None, 240)               │               0 │ block3b_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_se_reshape (Reshape)  │ (None, 1, 1, 240)         │               0 │ block3b_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_se_reduce (Conv2D)    │ (None, 1, 1, 10)          │           2,410 │ block3b_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_se_expand (Conv2D)    │ (None, 1, 1, 240)         │           2,640 │ block3b_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_se_excite (Multiply)  │ (None, 28, 28, 240)       │               0 │ block3b_activation[0][0],  │
│                               │                           │                 │ block3b_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_project_conv (Conv2D) │ (None, 28, 28, 40)        │           9,600 │ block3b_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_project_bn            │ (None, 28, 28, 40)        │             160 │ block3b_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_drop (Dropout)        │ (None, 28, 28, 40)        │               0 │ block3b_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block3b_add (Add)             │ (None, 28, 28, 40)        │               0 │ block3b_drop[0][0],        │
│                               │                           │                 │ block3a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_expand_conv (Conv2D)  │ (None, 28, 28, 240)       │           9,600 │ block3b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_expand_bn             │ (None, 28, 28, 240)       │             960 │ block4a_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_expand_activation     │ (None, 28, 28, 240)       │               0 │ block4a_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_dwconv_pad            │ (None, 29, 29, 240)       │               0 │ block4a_expand_activation… │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_dwconv                │ (None, 14, 14, 240)       │           2,160 │ block4a_dwconv_pad[0][0]   │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_bn                    │ (None, 14, 14, 240)       │             960 │ block4a_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_activation            │ (None, 14, 14, 240)       │               0 │ block4a_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_se_squeeze            │ (None, 240)               │               0 │ block4a_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_se_reshape (Reshape)  │ (None, 1, 1, 240)         │               0 │ block4a_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_se_reduce (Conv2D)    │ (None, 1, 1, 10)          │           2,410 │ block4a_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_se_expand (Conv2D)    │ (None, 1, 1, 240)         │           2,640 │ block4a_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_se_excite (Multiply)  │ (None, 14, 14, 240)       │               0 │ block4a_activation[0][0],  │
│                               │                           │                 │ block4a_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_project_conv (Conv2D) │ (None, 14, 14, 80)        │          19,200 │ block4a_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4a_project_bn            │ (None, 14, 14, 80)        │             320 │ block4a_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_expand_conv (Conv2D)  │ (None, 14, 14, 480)       │          38,400 │ block4a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_expand_bn             │ (None, 14, 14, 480)       │           1,920 │ block4b_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_expand_activation     │ (None, 14, 14, 480)       │               0 │ block4b_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_dwconv                │ (None, 14, 14, 480)       │           4,320 │ block4b_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_bn                    │ (None, 14, 14, 480)       │           1,920 │ block4b_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_activation            │ (None, 14, 14, 480)       │               0 │ block4b_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_se_squeeze            │ (None, 480)               │               0 │ block4b_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_se_reshape (Reshape)  │ (None, 1, 1, 480)         │               0 │ block4b_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_se_reduce (Conv2D)    │ (None, 1, 1, 20)          │           9,620 │ block4b_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_se_expand (Conv2D)    │ (None, 1, 1, 480)         │          10,080 │ block4b_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_se_excite (Multiply)  │ (None, 14, 14, 480)       │               0 │ block4b_activation[0][0],  │
│                               │                           │                 │ block4b_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_project_conv (Conv2D) │ (None, 14, 14, 80)        │          38,400 │ block4b_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_project_bn            │ (None, 14, 14, 80)        │             320 │ block4b_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_drop (Dropout)        │ (None, 14, 14, 80)        │               0 │ block4b_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4b_add (Add)             │ (None, 14, 14, 80)        │               0 │ block4b_drop[0][0],        │
│                               │                           │                 │ block4a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_expand_conv (Conv2D)  │ (None, 14, 14, 480)       │          38,400 │ block4b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_expand_bn             │ (None, 14, 14, 480)       │           1,920 │ block4c_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_expand_activation     │ (None, 14, 14, 480)       │               0 │ block4c_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_dwconv                │ (None, 14, 14, 480)       │           4,320 │ block4c_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_bn                    │ (None, 14, 14, 480)       │           1,920 │ block4c_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_activation            │ (None, 14, 14, 480)       │               0 │ block4c_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_se_squeeze            │ (None, 480)               │               0 │ block4c_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_se_reshape (Reshape)  │ (None, 1, 1, 480)         │               0 │ block4c_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_se_reduce (Conv2D)    │ (None, 1, 1, 20)          │           9,620 │ block4c_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_se_expand (Conv2D)    │ (None, 1, 1, 480)         │          10,080 │ block4c_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_se_excite (Multiply)  │ (None, 14, 14, 480)       │               0 │ block4c_activation[0][0],  │
│                               │                           │                 │ block4c_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_project_conv (Conv2D) │ (None, 14, 14, 80)        │          38,400 │ block4c_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_project_bn            │ (None, 14, 14, 80)        │             320 │ block4c_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_drop (Dropout)        │ (None, 14, 14, 80)        │               0 │ block4c_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block4c_add (Add)             │ (None, 14, 14, 80)        │               0 │ block4c_drop[0][0],        │
│                               │                           │                 │ block4b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_expand_conv (Conv2D)  │ (None, 14, 14, 480)       │          38,400 │ block4c_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_expand_bn             │ (None, 14, 14, 480)       │           1,920 │ block5a_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_expand_activation     │ (None, 14, 14, 480)       │               0 │ block5a_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_dwconv                │ (None, 14, 14, 480)       │          12,000 │ block5a_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_bn                    │ (None, 14, 14, 480)       │           1,920 │ block5a_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_activation            │ (None, 14, 14, 480)       │               0 │ block5a_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_se_squeeze            │ (None, 480)               │               0 │ block5a_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_se_reshape (Reshape)  │ (None, 1, 1, 480)         │               0 │ block5a_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_se_reduce (Conv2D)    │ (None, 1, 1, 20)          │           9,620 │ block5a_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_se_expand (Conv2D)    │ (None, 1, 1, 480)         │          10,080 │ block5a_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_se_excite (Multiply)  │ (None, 14, 14, 480)       │               0 │ block5a_activation[0][0],  │
│                               │                           │                 │ block5a_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_project_conv (Conv2D) │ (None, 14, 14, 112)       │          53,760 │ block5a_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5a_project_bn            │ (None, 14, 14, 112)       │             448 │ block5a_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_expand_conv (Conv2D)  │ (None, 14, 14, 672)       │          75,264 │ block5a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_expand_bn             │ (None, 14, 14, 672)       │           2,688 │ block5b_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_expand_activation     │ (None, 14, 14, 672)       │               0 │ block5b_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_dwconv                │ (None, 14, 14, 672)       │          16,800 │ block5b_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_bn                    │ (None, 14, 14, 672)       │           2,688 │ block5b_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_activation            │ (None, 14, 14, 672)       │               0 │ block5b_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_se_squeeze            │ (None, 672)               │               0 │ block5b_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_se_reshape (Reshape)  │ (None, 1, 1, 672)         │               0 │ block5b_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_se_reduce (Conv2D)    │ (None, 1, 1, 28)          │          18,844 │ block5b_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_se_expand (Conv2D)    │ (None, 1, 1, 672)         │          19,488 │ block5b_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_se_excite (Multiply)  │ (None, 14, 14, 672)       │               0 │ block5b_activation[0][0],  │
│                               │                           │                 │ block5b_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_project_conv (Conv2D) │ (None, 14, 14, 112)       │          75,264 │ block5b_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_project_bn            │ (None, 14, 14, 112)       │             448 │ block5b_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_drop (Dropout)        │ (None, 14, 14, 112)       │               0 │ block5b_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5b_add (Add)             │ (None, 14, 14, 112)       │               0 │ block5b_drop[0][0],        │
│                               │                           │                 │ block5a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_expand_conv (Conv2D)  │ (None, 14, 14, 672)       │          75,264 │ block5b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_expand_bn             │ (None, 14, 14, 672)       │           2,688 │ block5c_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_expand_activation     │ (None, 14, 14, 672)       │               0 │ block5c_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_dwconv                │ (None, 14, 14, 672)       │          16,800 │ block5c_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_bn                    │ (None, 14, 14, 672)       │           2,688 │ block5c_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_activation            │ (None, 14, 14, 672)       │               0 │ block5c_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_se_squeeze            │ (None, 672)               │               0 │ block5c_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_se_reshape (Reshape)  │ (None, 1, 1, 672)         │               0 │ block5c_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_se_reduce (Conv2D)    │ (None, 1, 1, 28)          │          18,844 │ block5c_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_se_expand (Conv2D)    │ (None, 1, 1, 672)         │          19,488 │ block5c_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_se_excite (Multiply)  │ (None, 14, 14, 672)       │               0 │ block5c_activation[0][0],  │
│                               │                           │                 │ block5c_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_project_conv (Conv2D) │ (None, 14, 14, 112)       │          75,264 │ block5c_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_project_bn            │ (None, 14, 14, 112)       │             448 │ block5c_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_drop (Dropout)        │ (None, 14, 14, 112)       │               0 │ block5c_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block5c_add (Add)             │ (None, 14, 14, 112)       │               0 │ block5c_drop[0][0],        │
│                               │                           │                 │ block5b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_expand_conv (Conv2D)  │ (None, 14, 14, 672)       │          75,264 │ block5c_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_expand_bn             │ (None, 14, 14, 672)       │           2,688 │ block6a_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_expand_activation     │ (None, 14, 14, 672)       │               0 │ block6a_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_dwconv_pad            │ (None, 17, 17, 672)       │               0 │ block6a_expand_activation… │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_dwconv                │ (None, 7, 7, 672)         │          16,800 │ block6a_dwconv_pad[0][0]   │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_bn                    │ (None, 7, 7, 672)         │           2,688 │ block6a_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_activation            │ (None, 7, 7, 672)         │               0 │ block6a_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_se_squeeze            │ (None, 672)               │               0 │ block6a_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_se_reshape (Reshape)  │ (None, 1, 1, 672)         │               0 │ block6a_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_se_reduce (Conv2D)    │ (None, 1, 1, 28)          │          18,844 │ block6a_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_se_expand (Conv2D)    │ (None, 1, 1, 672)         │          19,488 │ block6a_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_se_excite (Multiply)  │ (None, 7, 7, 672)         │               0 │ block6a_activation[0][0],  │
│                               │                           │                 │ block6a_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_project_conv (Conv2D) │ (None, 7, 7, 192)         │         129,024 │ block6a_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6a_project_bn            │ (None, 7, 7, 192)         │             768 │ block6a_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_expand_conv (Conv2D)  │ (None, 7, 7, 1152)        │         221,184 │ block6a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_expand_bn             │ (None, 7, 7, 1152)        │           4,608 │ block6b_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_expand_activation     │ (None, 7, 7, 1152)        │               0 │ block6b_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_dwconv                │ (None, 7, 7, 1152)        │          28,800 │ block6b_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_bn                    │ (None, 7, 7, 1152)        │           4,608 │ block6b_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_activation            │ (None, 7, 7, 1152)        │               0 │ block6b_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_se_squeeze            │ (None, 1152)              │               0 │ block6b_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_se_reshape (Reshape)  │ (None, 1, 1, 1152)        │               0 │ block6b_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_se_reduce (Conv2D)    │ (None, 1, 1, 48)          │          55,344 │ block6b_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_se_expand (Conv2D)    │ (None, 1, 1, 1152)        │          56,448 │ block6b_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_se_excite (Multiply)  │ (None, 7, 7, 1152)        │               0 │ block6b_activation[0][0],  │
│                               │                           │                 │ block6b_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_project_conv (Conv2D) │ (None, 7, 7, 192)         │         221,184 │ block6b_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_project_bn            │ (None, 7, 7, 192)         │             768 │ block6b_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_drop (Dropout)        │ (None, 7, 7, 192)         │               0 │ block6b_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6b_add (Add)             │ (None, 7, 7, 192)         │               0 │ block6b_drop[0][0],        │
│                               │                           │                 │ block6a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_expand_conv (Conv2D)  │ (None, 7, 7, 1152)        │         221,184 │ block6b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_expand_bn             │ (None, 7, 7, 1152)        │           4,608 │ block6c_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_expand_activation     │ (None, 7, 7, 1152)        │               0 │ block6c_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_dwconv                │ (None, 7, 7, 1152)        │          28,800 │ block6c_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_bn                    │ (None, 7, 7, 1152)        │           4,608 │ block6c_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_activation            │ (None, 7, 7, 1152)        │               0 │ block6c_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_se_squeeze            │ (None, 1152)              │               0 │ block6c_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_se_reshape (Reshape)  │ (None, 1, 1, 1152)        │               0 │ block6c_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_se_reduce (Conv2D)    │ (None, 1, 1, 48)          │          55,344 │ block6c_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_se_expand (Conv2D)    │ (None, 1, 1, 1152)        │          56,448 │ block6c_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_se_excite (Multiply)  │ (None, 7, 7, 1152)        │               0 │ block6c_activation[0][0],  │
│                               │                           │                 │ block6c_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_project_conv (Conv2D) │ (None, 7, 7, 192)         │         221,184 │ block6c_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_project_bn            │ (None, 7, 7, 192)         │             768 │ block6c_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_drop (Dropout)        │ (None, 7, 7, 192)         │               0 │ block6c_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6c_add (Add)             │ (None, 7, 7, 192)         │               0 │ block6c_drop[0][0],        │
│                               │                           │                 │ block6b_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_expand_conv (Conv2D)  │ (None, 7, 7, 1152)        │         221,184 │ block6c_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_expand_bn             │ (None, 7, 7, 1152)        │           4,608 │ block6d_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_expand_activation     │ (None, 7, 7, 1152)        │               0 │ block6d_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_dwconv                │ (None, 7, 7, 1152)        │          28,800 │ block6d_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_bn                    │ (None, 7, 7, 1152)        │           4,608 │ block6d_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_activation            │ (None, 7, 7, 1152)        │               0 │ block6d_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_se_squeeze            │ (None, 1152)              │               0 │ block6d_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_se_reshape (Reshape)  │ (None, 1, 1, 1152)        │               0 │ block6d_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_se_reduce (Conv2D)    │ (None, 1, 1, 48)          │          55,344 │ block6d_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_se_expand (Conv2D)    │ (None, 1, 1, 1152)        │          56,448 │ block6d_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_se_excite (Multiply)  │ (None, 7, 7, 1152)        │               0 │ block6d_activation[0][0],  │
│                               │                           │                 │ block6d_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_project_conv (Conv2D) │ (None, 7, 7, 192)         │         221,184 │ block6d_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_project_bn            │ (None, 7, 7, 192)         │             768 │ block6d_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_drop (Dropout)        │ (None, 7, 7, 192)         │               0 │ block6d_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block6d_add (Add)             │ (None, 7, 7, 192)         │               0 │ block6d_drop[0][0],        │
│                               │                           │                 │ block6c_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_expand_conv (Conv2D)  │ (None, 7, 7, 1152)        │         221,184 │ block6d_add[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_expand_bn             │ (None, 7, 7, 1152)        │           4,608 │ block7a_expand_conv[0][0]  │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_expand_activation     │ (None, 7, 7, 1152)        │               0 │ block7a_expand_bn[0][0]    │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_dwconv                │ (None, 7, 7, 1152)        │          10,368 │ block7a_expand_activation… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_bn                    │ (None, 7, 7, 1152)        │           4,608 │ block7a_dwconv[0][0]       │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_activation            │ (None, 7, 7, 1152)        │               0 │ block7a_bn[0][0]           │
│ (Activation)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_se_squeeze            │ (None, 1152)              │               0 │ block7a_activation[0][0]   │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_se_reshape (Reshape)  │ (None, 1, 1, 1152)        │               0 │ block7a_se_squeeze[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_se_reduce (Conv2D)    │ (None, 1, 1, 48)          │          55,344 │ block7a_se_reshape[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_se_expand (Conv2D)    │ (None, 1, 1, 1152)        │          56,448 │ block7a_se_reduce[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_se_excite (Multiply)  │ (None, 7, 7, 1152)        │               0 │ block7a_activation[0][0],  │
│                               │                           │                 │ block7a_se_expand[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_project_conv (Conv2D) │ (None, 7, 7, 320)         │         368,640 │ block7a_se_excite[0][0]    │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block7a_project_bn            │ (None, 7, 7, 320)         │           1,280 │ block7a_project_conv[0][0] │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ top_conv (Conv2D)             │ (None, 7, 7, 1280)        │         409,600 │ block7a_project_bn[0][0]   │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ top_bn (BatchNormalization)   │ (None, 7, 7, 1280)        │           5,120 │ top_conv[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ top_activation (Activation)   │ (None, 7, 7, 1280)        │               0 │ top_bn[0][0]               │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ global_average_pooling2d      │ (None, 1280)              │               0 │ top_activation[0][0]       │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout (Dropout)             │ (None, 1280)              │               0 │ global_average_pooling2d[… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense (Dense)                 │ (None, 1024)              │       1,311,744 │ dropout[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense_1 (Dense)               │ (None, 4)                 │           4,100 │ dense[0][0]                │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 16,012,201 (61.08 MB)
 Trainable params: 5,323,392 (20.31 MB)
 Non-trainable params: 42,023 (164.16 KB)
 Optimizer params: 10,646,786 (40.61 MB)